<!DOCTYPE html>
<html lang="it">
{{ partial "head.html" . }}
<body>

    {{ partial "nav.html" . }}

    <main>
        <div class="page-header">
            <h1>{{ .Title }}</h1>
        </div>

        <div class="content-container">
            {{ with .Params.image }}
            <img src="{{ . }}" alt="{{ $.Title }}" style="width:100%; max-height:400px; object-fit:cover; margin-bottom:2rem;">
            {{ end }}

            {{ if .Params.price }}
            <div style="background: #f4f7f6; padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem; text-align: center; border: 1px solid #e0e0e0;">
                <span style="font-family: 'Playfair Display', serif; font-size: 1.2rem; color: #2c3e50;">
                    Costo seduta: <strong>{{ .Params.price }}</strong>
                </span>
            </div>
            {{ end }}

            <div style="margin-bottom: 2rem; text-align: center">
                {{ .Content }}
            </div>

            <div class="contact-form-container">
                <form id="contactForm" action="https://formspree.io/f/xlgebrge" method="POST">
                    <div class="form-group">
                        <label for="name">Nome</label>
                        <input type="text" id="name" name="nome" placeholder="Il tuo nome" required>
                    </div>

                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" name="email" placeholder="La tua email" required>
                    </div>

                    <div class="form-group">
                        <label for="message">Messaggio</label>
                        <textarea id="message" name="messaggio" rows="5" placeholder="Come posso aiutarti?" required></textarea>
                    </div>

                    <button type="submit" class="btn-send">Invia Messaggio</button>
                </form>
            </div>

            {{ if eq .Section "trattamenti" }}
            <div style="margin-top: 3rem; text-align: center;">
                <a href="/trattamenti" style="display: inline-block; padding: 10px 20px; background-color: #2c3e50; color: white; border-radius: 50px; font-size: 0.9rem;">
                    ← Torna alla lista
                </a>
            </div>
            {{ end }}

        </div>
    </main>

    <script>
        var form = document.getElementById("contactForm");

        async function handleSubmit(event) {
          event.preventDefault(); // Blocca il comportamento standard
          var data = new FormData(event.target);

          fetch(event.target.action, {
            method: form.method,
            body: data,
            headers: {
                'Accept': 'application/json'
            }
          }).then(response => {
            if (response.ok) {
              // SE TUTTO VA BENE -> VAI ALLA PAGINA GRAZIE
              window.location.href = "https://www.oriettavandi.com/grazie";
            } else {
              // SE C'È UN ERRORE
              alert("C'è stato un problema nell'invio del messaggio. Riprova più tardi.");
            }
          }).catch(error => {
            alert("C'è stato un problema nell'invio del messaggio.");
          });
        }

        form.addEventListener("submit", handleSubmit)
    </script>

    {{ partial "footer.html" . }}

</body>
</html>